{% extends "base.html" %}
{% block content %}

<h3 class="mb-4 text-center">Admin Dashboard</h3>

<div class="text-center mb-4">
    <a href="/add-question" class="btn btn-success me-3">Add Question</a>
    <a href="/logout" class="btn btn-danger">Logout</a>
</div>

<div class="accordion" id="companyAccordion">

    {% for company in questions|groupby("company") %}

    <div class="accordion-item mb-4 shadow">

        <!-- Company Header -->
        <h2 class="accordion-header" id="heading{{ loop.index }}">
            <button class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#collapse{{ loop.index }}">

                <strong>{{ company.grouper }}</strong>
            </button>
        </h2>

        <!-- Company Questions -->
        <div id="collapse{{ loop.index }}"
             class="accordion-collapse collapse"
             data-bs-parent="#companyAccordion">

            <div class="accordion-body">

                <div class="accordion" id="innerAccordion{{ loop.index }}">

                    {% for q in company.list %}
                    <div class="accordion-item mb-2">

                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed"
                                    type="button"
                                    data-bs-toggle="collapse"
                                    data-bs-target="#question{{ q._id }}">

                                {{ q.category }} â€“
                                {{ q.question.split('\n')[0] }}
                            </button>
                        </h2>

                        <div id="question{{ q._id }}"
                             class="accordion-collapse collapse">

                            <div class="accordion-body">

                                <pre class="question-box">
{{ q.question }}
                                </pre>

                                <div class="mt-3">
                                    <a href="/edit-question/{{ q._id }}"
                                       class="btn btn-warning btn-sm me-2">
                                        Edit
                                    </a>

                                    <a href="/delete-question/{{ q._id }}"
                                        class="btn btn-danger btn-sm"
                                        onclick="return confirm('Are you sure you want to delete this question?');">
                                         Delete
                                    </a>

                                </div>

                            </div>
                        </div>

                    </div>
                    {% endfor %}

                </div>

            </div>

        </div>

    </div>

    {% endfor %}

</div>

{% endblock %}
